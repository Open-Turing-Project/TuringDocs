<html>
<head><title>File.Status</title></head>
<body>
<table width="100%"><tr valign="top"><td align="left"><font size="+2"><b>File.Status</b></font></td><td align="right">Part of <a href="filemodule.html">File</a> module</td></table><p>
<table><tr valign="top"><td><b>Syntax&nbsp;&nbsp;</b></td>
<td> <b>File.Status</b> (<i>pathName</i> : <b>string</b>, <b>var</b> <i>size</i>, <i>attribute</i>, <i>fileTime</i> : <b>int</b>)<p>
<tr valign="top"><td><b>Description&nbsp;&nbsp;</b></td>
<td> <b>File.Status </b>is used to get assorted information about a file or directory. When the function is called with a specified <i>pathName</i>, it returns the information about the file in the other parameters.<p>
The <i>size</i> parameter is the size of the file in bytes. <p>
The <i>attribute</i> parameter has its individual bits set as exactly as the <i>attribute</i> parameter in <b>Dir.GetLong</b> subprogram does. See <b>Dir.GetLong</b> for the list of attribute constants.<p>
The <i>fileTime</i> is the time of last modification of the file. It is returned as the number of seconds since 00:00:00 GMT 1/1/1970. To convert this to a string, use <b>Time.SecDate.</b><p>
<tr valign="top"><td><b>Details&nbsp;&nbsp;</b></td>
<td> If the <b>File.Status</b> call fails, <i>size</i>, <i>attribute</i> and <i>fileTime</i> are all set to 1. <b>Error.Last</b> will return a non-zero value indicating the reason for the failure. <b>Error.LastMsg</b> will return a string which contains the textual version of the error.<p>
<tr valign="top"><td><b>Example&nbsp;&nbsp;</b></td>
<td> This program prints information about the NotePad.exe application in Windows found
     at "<i>c:\windows\notepad.exe</i>". (Note on some systems, this will be "c:\winnt\notepade.exe"<p>
<pre><tt>        <b>const</b> <i>pathName</i> : <b>string</b> := "c:/windows/notepad.exe"
        <b>var</b> <i>size</i>, <i>attribute</i>, <i>fileTime</i> : <b>int</b>
        <b>File.Status </b>(<i>pathName</i>, <i>size</i>, <i>attribute</i>, <i>fileTime</i> )
        <b>if Error.Last</b> <b>=</b> <i>eNoError</i> <b>then</b>
            <b>put</b> "      Name: ", <b>File.FullPath</b> (<i>pathName</i>)
            <b>put</b> "   Created: ", <b>Time.SecDate</b> (<i>fileTime</i>)
            <b>put</b> "      Size: ", <i>size</i>, " bytes"
            <b>put</b> "Attributes: " ..
            <b>if</b> (attribute</i> <b>and ootAttrDir</b>) <b>not</b>= 0 <b>then</b>
                <b>put</b> "Directory " ..
            <b>else</b>
                <b>put</b> "" ..
            <b>end if</b>
            <b>if</b> (attribute</i> <b>and ootAttrRead</b>) <b>not</b>= 0 <b>then</b>
                <b>put</b> "Readable " ..
            <b>else</b>
                <b>put</b> "" ..
            <b>end if</b>
            <b>if</b> (attribute</i> <b>and ootAttrWrite</b>) <b>not</b>= 0 <b>then</b>
                <b>put</b> "Writable " ..
            <b>else</b>
                <b>put</b> "" ..
            <b>end if</b>
            <b>if</b> (attribute</i> <b>and ootAttrExecute</b>) <b>not</b>= 0 <b>then</b>
                <b>put</b> "Executable", <b>skip</b>
            <b>else</b>
                <b>put</b> <b>skip</b>
            <b>end if</b>
        <b>else</b>
            <b>put</b> "Unable to get file information"
            <b>put</b> "Error: ", <b>Error.LastMsg</b>, <b>skip</b>
        <b>end if</b></tt></pre><p>
<tr valign="top"><td><b>Execute&nbsp;&nbsp;</b></td>
<td><OBJECT id=launch type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=120 height=40>
  <PARAM name="Command" value="TCard">
  <PARAM name="Button" value="Text: Launch Example Program">
  <PARAM name="Item1" value="-1,File.Status.t;File.Status Example">
</OBJECT><p></td>
  <tr valign="top">
    <td><b>Execute&nbsp;&nbsp;</b></td>
    <td>Another example program is available that uses <b>File.Status</b> to 
        determine the status of several files and directories.<p>
        <OBJECT id=launch type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=120 height=40>
          <PARAM name="Command" value="TCard">
          <PARAM name="Button" value="Text: Launch Example Program">
          <PARAM name="Item1" value="-1,File.Status2.t;File.Status Example">
        </OBJECT><p></td>
  </tr>        
<tr valign="top"><td><b>Status&nbsp;&nbsp;</b></td>
<td> Exported qualified.<p>
This means that you can only call the function by calling <b>File.Status</b>, not by calling <b>Status</b>.<p>
</table></body>
</html>
